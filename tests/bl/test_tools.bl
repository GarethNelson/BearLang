; this file contains the tools for running automated tests

(= TESTS_PASSED 0)
(= TESTS_FAILED 0)
(= TESTS_RUN    0)

(oper TEST (testname testfunc)
      (= TESTING testfunc)
      (print "\tTesting " testname)

      (oper PASSTEST () 
            (if (not (isset TESTS_PASSED))
	             (= TESTS_PASSED 1)
                     (= TESTS_PASSED (+ TESTS_PASSED 1)))
            (print " PASS\n"))

      (oper FAILTEST ()
	    (if (not (isset TESTS_FAILED))
	             (= TESTS_FAILED 1)
		     (= TESTS_FAILED (+ TESTS_FAILED 1)))
	    (print " FAIL\n"))
      

      (if (TESTING) (PASSTEST)
                    (FAILTEST))

      (if (not (isset TESTS_RUN))
	       (= TESTS_RUN 1)
               (= (+ TESTS_RUN 1)))
      )


(fun TEST-SUMMARY ()
     (print TESTS_RUN     " Tests run,")
     (print TESTS_PASSED  " passed,")
     (print TESTS_FAILED  " failed\n"))
